# ğŸ‹ Antigravity Manager åŸç”Ÿ Docker éƒ¨ç½²æ‰‹å†Š

æœ¬ç›®éŒ„åŒ…å« Antigravity Manager çš„åŸç”Ÿ Headless Docker éƒ¨ç½²æ–¹æ¡ˆã€‚è©²æ–¹æ¡ˆæ”¯æŒå®Œæ•´çš„ Web ç®¡ç†ç•Œé¢ã€API åä»£ä»¥åŠæ•¸æ“šæŒä¹…åŒ–ï¼Œç„¡éœ€è¤‡é›œçš„ VNC æˆ–æ¡Œé¢ç’°å¢ƒã€‚

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. ç›´æ¥æ‹‰å–é¡åƒ (æ¨è–¦)
æ‚¨å¯ä»¥ç›´æ¥å¾ Docker Hub æ‹‰å–å·²æ§‹å»ºå¥½çš„é¡åƒä¸¦å•ŸåŠ¨ï¼Œç„¡éœ€ç²å–æºç¢¼ï¼š

> [!IMPORTANT]
> **å®‰å…¨è­¦å‘Š**ï¼šå¾ v4.0.3 é–‹å§‹ï¼ŒDocker ç‰ˆæ”¯æŒ **ç®¡ç†å¯†ç¢¼èˆ‡ API Key åˆ†é›¢**ï¼š
> *   **API Key**ï¼šé€šé `-e API_KEY=xxx` è¨­ç½®ï¼Œç”¨æ–¼æ‰€æœ‰ AI å”è­°çš„ API èª¿ç”¨é‘’æ¬Šã€‚
> *   **Web ç®¡ç†å¯†ç¢¼**ï¼šé€šé `-e WEB_PASSWORD=xxx` è¨­ç½®ï¼Œåƒ…ç”¨æ–¼ Web UI ç™»éŒ„ã€‚
> *   **é»˜èªè¡Œç‚º**ï¼šè‹¥æœªè¨­ç½® `WEB_PASSWORD`ï¼Œç³»çµ±æœƒè‡ªå‹•å›é€€ä½¿ç”¨ `API_KEY` ä½œç‚ºç™»éŒ„å¯†ç¢¼ã€‚è‹¥å…©è€…çš†æœªè¨­ç½®ï¼Œå‰‡ç”Ÿæˆéš¨æ©Ÿ Keyã€‚
> *   **æŸ¥çœ‹æ–¹å¼**ï¼šåŸ·è¡Œ `docker logs antigravity-manager` å°‹æ‰¾ `Current API Key` æˆ– `Web UI Password`ï¼Œæˆ–åŸ·è¡Œ `grep -E '"api_key"|"admin_password"' ~/.antigravity_tools/gui_config.json` æŸ¥çœ‹ã€‚

```bash
# å•Ÿå‹•å®¹å™¨ (è«‹æ›¿æ¢ your-secret-key ç‚ºå¼·å¯†é‘°)
docker run -d \
  --name antigravity-manager \
  -p 8045:8045 \
  -e API_KEY=your-api-key \
  -e WEB_PASSWORD=your-login-password \
  -e ABV_MAX_BODY_SIZE=104857600 \
  -v ~/.antigravity_tools:/root/.antigravity_tools \
  lbjlaq/antigravity-manager:latest
```

#### ğŸ” é‘’æ¬Šé‚è¼¯ (Security Scenarios)
*   **å ´æ™¯ Aï¼šåƒ…è¨­ç½®äº† `API_KEY`**
    - **Web ç™»éŒ„**ï¼šä½¿ç”¨ `API_KEY` å³å¯é€²å…¥å¾Œå°ã€‚
    - **API èª¿ç”¨**ï¼šä½¿ç”¨ `API_KEY` é€²è¡Œ AI è«‹æ±‚é‘’æ¬Šã€‚
*   **å ´æ™¯ Bï¼šåŒæ™‚è¨­ç½®äº† `API_KEY` å’Œ `WEB_PASSWORD` (æ¨è–¦)**
    - **Web ç™»éŒ„**ï¼š**å¿…é ˆ**ä½¿ç”¨ `WEB_PASSWORD`ã€‚æ­¤æ™‚è¼¸å…¥ API Key å°‡è¢«æ‹’çµ•ï¼Œç¢ºä¿ç®¡ç†æ¬Šé™èˆ‡èª¿ç”¨æ¬Šé™éš”é›¢ã€‚
    - **API èª¿ç”¨**ï¼šç¹¼çºŒä½¿ç”¨ `API_KEY`ã€‚æ‚¨å¯ä»¥æ”¾å¿ƒåœ°å°‡ API Key åˆ†ç™¼çµ¦åœ˜éšŠæˆå“¡ï¼Œè€Œä¿ç•™å¯†ç¢¼åƒ…ä¾›ç®¡ç†å“¡ä½¿ç”¨ã€‚

#### ğŸ†™ èˆŠç‰ˆæœ¬å‡ç´šæŒ‡å¼•
å¦‚æœæ‚¨æ˜¯å¾èˆŠç‰ˆæœ¬å‡ç´šï¼Œé»˜èªæ²’æœ‰è¨­ç½® `WEB_PASSWORD`ã€‚æ‚¨å¯ä»¥é€šéä»¥ä¸‹æ–¹å¼æ·»åŠ ï¼š
1.  **Web UI (æ¨è–¦)**ï¼šä½¿ç”¨åŸæœ‰çš„ `API_KEY` ç™»éŒ„ï¼Œåœ¨ **API åä»£** è¨­ç½®é é¢ä¸­è¨­ç½®æ–°çš„ç®¡ç†å¯†ç¢¼ã€‚
2.  **ç’°å¢ƒè®Šé‡**ï¼šåœæ­¢èˆŠå®¹å™¨ï¼Œå•Ÿå‹•æ–°å®¹å™¨æ™‚å¢åŠ  `-e WEB_PASSWORD=æ‚¨çš„æ–°å¯†ç¢¼`ã€‚

> [!TIP]
> **å„ªå…ˆç´šé‚è¼¯ (Priority)**:
> - **ç’°å¢ƒè®Šé‡** (`ABV_WEB_PASSWORD` / `WEB_PASSWORD`) å…·æœ‰æœ€é«˜å„ªå…ˆç´šã€‚å¦‚æœè¨­ç½®äº†ç’°å¢ƒè®Šé‡ï¼Œç¨‹åºå°‡å§‹çµ‚ä½¿ç”¨å®ƒï¼Œå¿½ç•¥é…ç½®æ–‡ä»¶ä¸­çš„å€¼ã€‚
> - **é…ç½®æ–‡ä»¶** (`gui_config.json`) ç”¨æ–¼æŒä¹…åŒ–å­˜å„²ã€‚ç•¶æ‚¨é€šé Web UI ä¿®æ”¹å¯†ç¢¼ä¸¦ä¿å­˜æ™‚ï¼Œæ–°å¯†ç¢¼æœƒå¯«å…¥æ­¤æ–‡ä»¶ï¼ˆJSON å­—æ®µåç‚º `admin_password`ï¼‰ã€‚
> - **å›é€€æ©Ÿåˆ¶**: å¦‚æœä¸Šè¿°å…©è€…çš†æœªè¨­ç½®ï¼Œå‰‡å›é€€ä½¿ç”¨ `API_KEY`ï¼›è‹¥é€£ `API_KEY` ä¹Ÿæœªè¨­ç½®ï¼Œå‰‡éš¨æ©Ÿç”Ÿæˆã€‚

### 2. ä½¿ç”¨ Docker Compose
åœ¨ `docker` ç›®éŒ„ä¸‹åŸ·è¡Œï¼š
```bash
docker compose up -d
```

### 3. æ‰‹å‹•æ§‹å»ºé¡åƒ (é–‹ç™¼è€…)
å¦‚æœæ‚¨éœ€è¦ä¿®æ”¹ä»£ç¢¼æˆ–è‡ªå®šç¾©æ§‹å»ºï¼Œè«‹åœ¨é …ç›®æ ¹ç›®éŒ„ä¸‹åŸ·è¡Œï¼š
```bash
# é»˜èªæ§‹å»ºæœ€æ–°æ¨™ç±¤
docker build -t antigravity-manager:latest -f docker/Dockerfile .
```

#### ğŸ’¡ æ§‹å»ºåƒæ•¸
æœ¬é¡åƒæ”¯æŒè‡ªå‹•é¡åƒæºåˆ‡æ›ï¼Œä»¥æå‡å›½å†…æ§‹å»ºé€Ÿåº¦ï¼š
*   `USE_MIRROR`: 
    *   `auto` (é»˜èª): è‡ªå‹•æª¢æ¸¬ç¶²çµ¡ç’°å¢ƒï¼Œè‹¥ç„¡æ³•è¨ªå• Google å‰‡åˆ‡æ›è‡³å›½å†…é•œåƒï¼ˆé˜¿é‡Œäº‘/NPM Mirrorï¼‰ã€‚
    *   `true`: å¼·åˆ¶ä½¿ç”¨å›½å†…é•œåƒæºã€‚
    *   `false`: å¼·åˆ¶ä½¿ç”¨å®˜æ–¹é»˜èªæºã€‚

ç¤ºä¾‹ï¼š
```bash
# å¼·åˆ¶ä½¿ç”¨å›½å†…é•œåƒåŠ é€Ÿæ§‹å»º
docker build --build-arg USE_MIRROR=true -t antigravity-manager:latest -f docker/Dockerfile .
```

## âš™ï¸ ç’°å¢ƒè®Šé‡é…ç½®

| è®Šé‡å | é»˜èªå€¼ | èªªæ˜ |
| :--- | :--- | :--- |
| `PORT` | `8045` | å®¹å™¨å…§æœå‹™ç›£è½ç«¯å£ |
| `ABV_API_KEY` | - | **[é‡è¦]** ä»£ç† API å¯†é‘°ã€‚å®¢æˆ¶ç«¯ï¼ˆå¦‚ Claude Codeï¼‰è¨ªå•æ™‚éœ€æä¾›çš„ Key |
| `ABV_WEB_PASSWORD` | - | **[å®‰å…¨]** Web ç®¡ç†å¾Œå°ç™»éŒ„å¯†ç¢¼ã€‚è‹¥ä¸è¨­ç½®å‰‡å›é€€ä½¿ç”¨ API Key |
| `ABV_MAX_BODY_SIZE` | `104857600` | **[æ€§èƒ½]** æœ€å¤§è«‹æ±‚é«”é™åˆ¶ (Byte)ã€‚é»˜èª 100MBï¼Œç”¨æ–¼è§£æ±ºå¤§åœ–å‚³è¼¸ 413 éŒ¯èª¤ |
| `LOG_LEVEL` | `info` | æ—¥å¿—ç­‰ç´š (debug, info, warn, error) |
| `ABV_DIST_PATH` | `/app/dist` | å‰ç«¯éœæ…‹è³‡æºè¨—ç®¡è·¯å¾‘ (Dockerfile å·²å…§ç½®) |
| `ABV_PUBLIC_URL` | - | ç”¨æ–¼é ç¨‹ OAuth å›èª¿çš„å…¬ç¶² URL (å¯é¸) |

## ğŸ“‚ æ•¸æ“šæŒä¹…åŒ–
è«‹å‹™å¿…å°‡å®¿ä¸»æ©Ÿç›®éŒ„æ›è¼‰è‡³å®¹å™¨å…§çš„ `/root/.antigravity_tools`ï¼Œå¦å‰‡è³¬è™Ÿå’Œé…ç½®åœ¨å®¹å™¨é‡å•Ÿå¾Œæœƒä¸Ÿå¤±ã€‚

## ğŸŒ è¨ªå•ä½å€
*   **ç®¡ç†ç•Œé¢**: [http://localhost:8045](http://localhost:8045)
*   **API Base**: [http://localhost:8045/v1](http://localhost:8045/v1)

## ğŸ“¦ Docker Hub åˆ†ç™¼ (æ¨è–¦)
è‹¥è¦æ¨é€è‡³ä½ çš„å€‰åº«ï¼š
```bash
# æ‰“ä¸Šç‰ˆæœ¬æ¨™ç±¤ä¸¦æ¨é€
docker tag antigravity-manager:latest lbjlaq/antigravity-manager:latest
docker tag antigravity-manager:latest lbjlaq/antigravity-manager:4.0.15
docker push lbjlaq/antigravity-manager:latest
docker push lbjlaq/antigravity-manager:4.0.15
```
